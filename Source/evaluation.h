/*
  Monolith 0.3  Copyright (C) 2017 Jonas Mayr

  This file is part of Monolith.

  Monolith is free software: you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation, either version 3 of the License, or
  (at your option) any later version.

  Monolith is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
  GNU General Public License for more details.

  You should have received a copy of the GNU General Public License
  along with Monolith. If not, see <http://www.gnu.org/licenses/>.
*/


#pragma once

#include "position.h"
#include "main.h"

// evaluating a position statically

namespace eval
{
	// evaluating functions

	void pieces(pos &board, int sum[][2]);
	void pawns(pos &board, int sum[][2]);

	int static_eval(pos &board);

	void init();

	// material weights

	const int value[2][6]
	{
		{  90, 320, 330, 500, 1000, 0 },
		{ 100, 320, 350, 550, 1050, 0 }
	};

	// piece weights

	const int bishop_pair[2]
	{ 15, 30 };
	const int major_behind_pp[2]
	{ 10, 20 };
	const int rook_on_7th[2]
	{ 10, 20 };
	const int knights_connected
	{ 10 };
	const int rook_open_file
	{ 25 };

	// king safety weights
	// derived from Toga

	const int king_safety_w[8]
	{
		0, 0, 50, 75, 88, 94, 97, 99
	};
	const int king_threat[5]
	{
		0, 20, 20, 40, 80
	};

	// passed pawn weights

	static int passed_pawn[2][8]
	{
		{ 0, 0, 0, 20, 60, 110, 170, 0 }
	};
	
	// mobility weights
	// derived from Glaurung by Tord Romstad

	const int bishop_mob[2][14]
	{
		{ -15, -10, 0, 10, 18, 25, 30, 34, 37, 39, 40, 41, 42, 43 },
		{ -15, -10, 0, 10, 18, 25, 30, 34, 37, 39, 40, 41, 42, 43 }
	};
	const int rook_mob[2][15]
	{
		{  -8,  -5, -3, 0, 3,  5,  8, 10, 12, 13, 14, 15, 16, 17, 18 },
		{ -18, -10, -4, 2, 8, 14, 20, 26, 32, 37, 40, 42, 43, 44, 45 }
	};
	const int queen_mob[2][28]
	{
		{  -4, -3, -2, -1,  0,  1,  2,  3,  4,  5,  6,  6,  7,  7,
		    8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8 },
		{ -10, -8, -6, -4, -2,  0,  2,  4,  6,  8, 10, 12, 13, 14,
		   14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14 }
	};
	const int knight_mob[2][9]
	{
		{ -20, -15, -8, 0, 8, 12, 15, 17, 18 },
		{ -20, -15, -8, 0, 8, 12, 15, 17, 18 }
	};

	// piece square table

	static int psqt[2][6][2][64] // [color][piece][stage][value]
	{
		{
			{
				{ // [PAWNS][MG][]
					 0,  0,  0,  0,  0,  0,  0,  0,
					50, 50, 50, 50, 50, 50, 50, 50,
					10, 10, 20, 30, 30, 20, 10, 10,
					 5,  5, 10, 25, 25, 10,  5,  5,
					 0,  0,  0, 20, 20,  0,  0,  0,
					 5, -5,-10,  0,  0,-10, -5,  5,
					 5, 10, 10,-25,-25, 10, 10,  5,
					 0,  0,  0,  0,  0,  0,  0,  0
				},
				{ // [PAWNS][EG][]
					 0,  0,  0,  0,  0,  0,  0,  0,
					30, 35, 45, 50, 50, 45, 35, 30,
					15, 20, 25, 30, 30, 25, 20, 15,
					 6,  8, 10, 15, 15, 10,  8,  6,
					 3,  5,  5, 10, 10,  5,  3,  3,
					 0,  3,  3,  6,  6,  3,  3,  0,
					-3,  0,  0,  3,  3,  0,  0, -3,
					 0,  0,  0,  0,  0,  0,  0,  0
				}
		    },
			{
				{ // [KNIGHTS][MG][]
					-40,-30,-20,-20,-20,-20,-30,-40,
					-20,-10,  0,  0,  0,  0,-10,-20,
					-10,  0, 10, 15, 15, 10,  0,-10,
					-10,  0, 15, 20, 20, 15,  0,-10,
					-10,  0, 15, 20, 20, 15,  0,-10,
					-10,  0, 10, 15, 15, 10,  0,-10,
					-20,-10,  0,  0,  0,  0,-10,-20,
					-40,-30,-20,-20,-20,-20,-30,-40
				},
				{ // [KNIGHTS][EG][]
					-40,-30,-20,-20,-20,-20,-30,-40,
					-20,-10,  0,  0,  0,  0,-10,-20,
					-10,  0, 10, 15, 15, 10,  0,-10,
					-10,  0, 15, 20, 20, 15,  0,-10,
					-10,  0, 15, 20, 20, 15,  0,-10,
					-10,  0, 10, 15, 15, 10,  0,-10,
					-20,-10,  0,  0,  0,  0,-10,-20,
					-40,-30,-20,-20,-20,-20,-30,-40
				}
			},
			{
				{ // [BISHOPS][MG][]
					-10,-10, -5, -5, -5, -5,-10,-10,
					-10,  0,  0,  0,  0,  0,  0,-10,
					 -5,  0,  5,  5,  5,  5,  0, -5,
					 -5,  3,  5, 10, 10,  5,  3, -5,
					 -5,  0,  5, 10, 10,  5,  0, -5,
					 -5,  5,  5,  5,  5,  5,  5, -5,
					-10,  3,  0,  0,  0,  0,  3,-10,
					-20,-20,-15,-15,-15,-15,-20,-20
				},
				{ // [BISHOPS][EG][]
					-20,-15,-10, -5, -5,-10,-15,-20,
					-15,  0,  0,  0,  0,  0,  0,-15,
					-10,  0,  5,  5,  5,  5,  0,-10,
					 -5,  0,  5, 10, 10,  5,  0, -5,
					 -5,  0,  5, 10, 10,  5,  0, -5,
					-10,  0,  5,  5,  5,  5,  0,-10,
					-15,  0,  0,  0,  0,  0,  0,-15,
					-20,-15,-10, -5, -5,-10,-15,-20
				}
			},
			{
				{ // [ROOKS][MG][]
					-8, -5,  0,  5,  5,  0, -5, -8,
					-8, -5,  0,  5,  5,  0, -5, -8,
					-8, -5,  0,  5,  5,  0, -5, -8,
					-8, -5,  0,  5,  5,  0, -5, -8,
					-8, -5,  0,  5,  5,  0, -5, -8,
					-8, -5,  0,  5,  5,  0, -5, -8,
					-8, -5,  0,  5,  5,  0, -5, -8,
					-8, -5,  0,  5,  5,  0, -5, -8
				},
				{ // [ROOKS][EG][]
					0,  0,  0,  0,  0,  0,  0,  0,
					0,  0,  0,  0,  0,  0,  0,  0,
					0,  0,  0,  0,  0,  0,  0,  0,
					0,  0,  0,  0,  0,  0,  0,  0,
					0,  0,  0,  0,  0,  0,  0,  0,
					0,  0,  0,  0,  0,  0,  0,  0,
					0,  0,  0,  0,  0,  0,  0,  0,
					0,  0,  0,  0,  0,  0,  0,  0,
				}
			},
			{
				{ // [QUEENS][MG][]
					-15,-10,-10, -5, -5,-10,-10,-15,
					-10,  0,  0,  0,  0,  0,  0,-10,
					-10,  0,  5,  5,  5,  5,  0,-10,
					 -5,  0,  5,  5,  5,  5,  0, -5,
					 -5,  0,  5,  5,  5,  5,  0, -5,
					-10,  0,  5,  5,  5,  5,  0,-10,
					-10,  0,  0,  0,  0,  0,  0,-10,
					-15,-10,-10, -5, -5,-10,-10,-15
				},
				{ // [QUEENS][EG][]
					-5, -5, -5, -5, -5, -5, -5, -5,
					-5,  0,  0,  0,  0,  0,  0, -5,
					-5,  0,  5,  5,  5,  5,  0, -5,
					-5,  0,  5,  8,  8,  5,  0, -5,
					-5,  0,  5,  8,  8,  5,  0, -5,
					-5,  0,  5,  5,  5,  5,  0, -5,
					-5,  0,  0,  0,  0,  0,  0, -5,
					-5, -5, -5, -5, -5, -5, -5, -5
				}
			},
			{
				{ // [KINGS][MG][]
					-20,-10,-30,-50,-50,-30,-10,-20,
					-10,  0,-20,-40,-40,-20,  0,-10,
					 -5,  5,-15,-35,-35,-15,  5, -5,
					  0, 10,-10,-30,-30,-10, 10,  0,
					 10, 20,  0,-20,-20,  0, 20, 10,
					 15, 25,  5,-15,-15,  5, 25, 15,
					 30, 40, 20,  0,  0, 20, 40, 30,
					 35, 45, 25,  5,  5, 25, 45, 35
				},
				{  // [KINGS][EG][]
					-70,-50,-40,-30,-30,-40,-50,-70,
					-50,-20,-10, -5, -5,-10,-20,-50,
					-40,-10,  0, 20, 20,  0,-10,-40,
					-30, -5, 20, 30, 30, 20, -5,-30,
					-30, -5, 20, 30, 30, 20, -5,-30,
					-40,-10,  0, 20, 20,  0,-10,-40,
					-50,-20,-10, -5, -5,-10,-20,-50,
					-70,-50,-40,-30,-30,-40,-50,-70
				}
			}
        }
	};
};
