/*
  Monolith 0.2  Copyright (C) 2017 Jonas Mayr

  This file is part of Monolith.

  Monolith is free software: you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation, either version 3 of the License, or
  (at your option) any later version.

  Monolith is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
  GNU General Public License for more details.

  You should have received a copy of the GNU General Public License
  along with Monolith. If not, see <http://www.gnu.org/licenses/>.
*/


#pragma once

#include "position.h"
#include "main.h"

namespace eval
{
	// evaluation functions

	void pieces(pos &board, int sum[][2]);
	void pawns(pos &board, int sum[][2]);

	int eval_board(pos &board);

	void init();

	// material weights

	const int value[2][6]
	{
		{  90, 500, 320, 330,  970, 0 },
		{ 100, 550, 320, 350, 1000, 0 }
	};

	// piece weights

	const int bishop_pair[2]
	{ 30, 60 };
	const int knights_connected[2]
	{ 10, 10 };
	const int major_behind_pp[2]
	{ 10, 20 };
	const int rook_open_file
	{ 8 };
	const int tempo_bonus_white
	{ 10 };

	// king safety weights

	const int king_safety_w[8]
	{
		0, 0, 50, 75, 88, 94, 97, 99
	};
	const int king_threat[5]
	{
		0, 40, 20, 20, 80
	};

	// passed pawn weights

	static int passed_pawn[2][64]
	{
	{
		  0,   0,   0,   0,   0,   0,   0,   0,
		150, 130, 120, 110, 110, 120, 130, 150,
		104,  96,  88,  80,  80,  88,  96, 104,
		 70,  65,  60,  55,  55,  60,  65,  70,
		 50,  45,  40,  35,  35,  40,  45,  50,
		 28,  25,  23,  20,  20,  23,  25,  28,
		 15,  13,  12,  10,  10,  12,  13,  15,
		  0,   0,   0,   0,   0,   0,   0,   0,
	}
	};

	// mobility weights

	const int bishop_mob[2][14]
	{
		{ -15, -10, 0, 10, 18, 25, 30, 34, 37, 39, 40, 41, 42, 43 },
		{ -15, -10, 0, 10, 18, 25, 30, 34, 37, 39, 40, 41, 42, 43 }
	};
	const int rook_mob[2][15]
	{
		{  -8,  -5, -3, 0, 3,  5,  8, 10, 12, 13, 14, 15, 16, 17, 18 },
		{ -18, -10, -4, 2, 8, 14, 20, 26, 32, 37, 40, 42, 43, 44, 45 }
	};
	const int queen_mob[2][28]
	{
		{  -4, -3, -2, -1,  0,  1,  2,  3,  4,  5,  6,  6,  7,  7,
		    8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8 },
		{ -10, -8, -6, -4, -2,  0,  2,  4,  6,  8, 10, 12, 13, 14,
		   14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14 }
	};
	const int knight_mob[2][9]
	{
		{ -15, -10, -5, 0, 5, 8, 10, 12, 13 },
		{ -15, -10, -5, 0, 5, 8, 10, 12, 13 }
	};

	// piece square table

	static int p_s_table[2][6][2][64] // [color][piece][stage][value]
	{
	{
			{
				{ // [PAWNS][MG][]
					 0,  0,  0,  0,  0,  0,  0,  0,
					50, 50, 50, 50, 50, 50, 50, 50,
					10, 10, 20, 30, 30, 20, 10, 10,
					 5,  5, 10, 25, 25, 10,  5,  5,
					 0,  0,  0, 20, 20,  0,  0,  0,
					 5, -5,-10,  0,  0,-10, -5,  5,
					 5, 10, 10,-25,-25, 10, 10,  5,
					 0,  0,  0,  0,  0,  0,  0,  0
				},
				{ // [PAWNS][EG][]
					 0,  0,  0,  0,  0,  0,  0,  0,
					65, 70, 70, 70, 70, 70, 70, 65,
					35, 40, 40, 40, 40, 40, 40, 35,
					15, 20, 20, 20, 20, 20, 20, 15,
					10, 10, 10, 10, 10, 10, 10, 10,
					 5,  5,  5,  5,  5,  5,  5,  5,
					 0,  0,  0,  0,  0,  0,  0,  0,
					 0,  0,  0,  0,  0,  0,  0,  0
				}
			},
			{
				{ // [ROOKS][MG][]
					 0,  0,  0,  0,  0,  0,  0,  0,
					 5, 10, 10, 10, 10, 10, 10,  5,
					-5,  0,  0,  0,  0,  0,  0, -5,
					-5,  0,  0,  0,  0,  0,  0, -5,
					-5,  0,  0,  0,  0,  0,  0, -5,
					-5,  0,  0,  0,  0,  0,  0, -5,
					-5,  0,  0,  0,  0,  0,  0, -5,
					 0,  0,  0,  5,  5,  0,  0,  0
				},
				{ // [ROOKS][EG][]
					 0,  0,  0,  0,  0,  0,  0,  0,
					 0,  0,  0,  0,  0,  0,  0,  0,
					 0,  0,  0,  0,  0,  0,  0,  0,
					 0,  0,  0,  0,  0,  0,  0,  0,
					 0,  0,  0,  0,  0,  0,  0,  0,
					 0,  0,  0,  0,  0,  0,  0,  0,
					 0,  0,  0,  0,  0,  0,  0,  0,
					 0,  0,  0,  0,  0,  0,  0,  0,
				}
			},
			{
				{ // [KNIGHTS][MG][]
					-40,-30,-20,-20,-20,-20,-30,-40,
					-20,-10,  0,  0,  0,  0,-10,-20,
					-10,  0, 10, 15, 15, 10,  0,-10,
					-10,  0, 15, 20, 20, 15,  0,-10,
					-10,  0, 15, 20, 20, 15,  0,-10,
					-10,  0, 10, 15, 15, 10,  0,-10,
					-20,-10,  0,  0,  0,  0,-10,-20,
					-40,-30,-20,-20,-20,-20,-30,-40
				},
				{  // [KNIGHTS][EG][]
					-40,-30,-20,-20,-20,-20,-30,-40,
					-20,-10,  0,  0,  0,  0,-10,-20,
					-10,  0, 10, 15, 15, 10,  0,-10,
					-10,  0, 15, 20, 20, 15,  0,-10,
					-10,  0, 15, 20, 20, 15,  0,-10,
					-10,  0, 10, 15, 15, 10,  0,-10,
					-20,-10,  0,  0,  0,  0,-10,-20,
					-40,-30,-20,-20,-20,-20,-30,-40
				}
			},
			{
				{ // [BISHOPS][MG][]
					-10, -5, -5, -5, -5, -5, -5,-10,
					-10,  0,  0,  0,  0,  0,  0,-10,
					-10,  0,  5, 10, 10,  5,  0,-10,
					-10,  5,  5, 10, 10,  5,  5,-10,
					-10,  0, 10, 10, 10, 10,  0,-10,
					-10, 10, 10, 10, 10, 10, 10,-10,
					-10,  5,  0,  0,  0,  0,  5,-10,
					-20,-10,-10,-10,-10,-10,-10,-20
				},
				{ // [BISHOPS][EG][]
					-10, -5, -5, -5, -5, -5, -5,-10,
					-10,  0,  0,  0,  0,  0,  0,-10,
					-10,  0, 10, 10, 10, 10,  0,-10,
					-10,  0, 10, 12, 12, 10,  0,-10,
					-10,  0, 10, 12, 12, 10,  0,-10,
					-10,  0, 10, 10, 10, 10,  0,-10,
					-10,  0,  0,  0,  0,  0,  0,-10,
					-20,-10,-10,-10,-10,-10,-10,-20
				}
			},
			{
				{ // [QUEENS][MG][]
					-15,-10,-10, -5, -5,-10,-10,-15,
					-10,  0,  0,  0,  0,  0,  0,-10,
					-10,  0,  5,  5,  5,  5,  0,-10,
					 -5,  0,  5,  5,  5,  5,  0, -5,
					 -5,  0,  5,  5,  5,  5,  0, -5,
					-10,  0,  5,  5,  5,  5,  0,-10,
					-10,  0,  0,  0,  0,  0,  0,-10,
					-15,-10,-10, -5, -5,-10,-10,-15
				},
				{ // [QUEENS][EG][]
					 -5, -5, -5, -5, -5, -5, -5, -5,
					 -5,  0,  0,  0,  0,  0,  0, -5,
					 -5,  0,  5,  5,  5,  5,  0, -5,
					 -5,  0,  5,  8,  8,  5,  0, -5,
					 -5,  0,  5,  8,  8,  5,  0, -5,
					 -5,  0,  5,  5,  5,  5,  0, -5,
					 -5,  0,  0,  0,  0,  0,  0, -5,
					 -5, -5, -5, -5, -5, -5, -5, -5
				}
			},
			{
				{ // [KINGS][MG][]
					-30,-40,-40,-50,-50,-40,-40,-30,
					-30,-40,-40,-50,-50,-40,-40,-30,
					-30,-40,-40,-50,-50,-40,-40,-30,
					-30,-40,-40,-50,-50,-40,-40,-30,
					-20,-30,-30,-40,-40,-30,-30,-20,
					-10,-20,-20,-30,-30,-20,-20,-10,
					  0, 10,-20,-20,-20,-20, 10,  0,
					 10, 30, 20,  0,  0,  0, 30, 10
				},
				{  // [KINGS][EG][]
					-50,-40,-30,-20,-20,-30,-40,-50,
					-30,-20,-10,  0,  0,-10,-20,-30,
					-30,-10, 20, 30, 30, 20,-10,-30,
					-30,-10, 30, 40, 40, 30,-10,-30,
					-30,-10, 30, 40, 40, 30,-10,-30,
					-30,-10, 20, 30, 30, 20,-10,-30,
					-30,-20,  0,  0,  0,  0,-20,-30,
					-50,-30,-30,-30,-30,-30,-30,-50
				}
			}
	}
	};
};
